schemaVersion: 1.0
routes:
  - if:
      command: "/assess-code-quality"
    then: ["auditor"]
  - if:
      command: "/implement-task"
    then: ["tester","executor","validator"]
  - if:
      command: "/monitor-pipeline"
    then: ["guardian"]
  - if:
      command: "/analyze-fixes"
    then: ["scholar"]
  - if:
      command: "/coordinate-agents"
    then: ["strategist"]
  - if:
      event: "pr.opened"
    then: ["validator","typechecker","security"]
  - if:
      event: "pr.synchronize"
    then: ["validator","typechecker"]
  - if:
      event: "backlog.needs_planning"
    then: ["strategist"]
  - if:
      event: "assessment.completed"
    then: ["strategist"]
  - if:
      event: "ci.pipeline.failed"
    then: ["guardian"]
  - if:
      event: "tests.flaky.detected"
    then: ["guardian"]
  - if:
      event: "push.main"
    then: ["auditor"]
  - if:
      event: "task.approved.fixpack"
    then: ["executor"]
  - if:
      event: "task.start.fixpack"
    then: ["tester"]
  - if:
      event: "assessment.lint.issues"
    then: ["linter"]
  - if:
      schedule: "nightly"
    then: ["auditor","security"]
  - if:
      schedule: "weekly"
    then: ["scholar"]
defaults:
  coordinator: "strategist"
  linearMediator: "strategist"
  maxConcurrentSubagents: 10
  fallback: "strategist"       # When no route matches